name: Lint

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  swiftlint:
    runs-on: macos-14

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install Homebrew dependencies
        run: |
          # Usa el Brewfile del repo para instalar solo lo necesario
          if [ -f Brewfile ]; then
            brew update
            # Intento normal; si alguna versión da lata, no forzamos upgrade de todo
            brew bundle --file=Brewfile || brew bundle --file=Brewfile --no-upgrade
          fi

      - name: Run SwiftLint
        run: |
          if which swiftlint >/dev/null; then
            swiftlint --strict --config .swiftlint.yml
          else
            echo "SwiftLint no está instalado. Revisa tu Brewfile o instala swiftlint en este job."
            exit 1
          fi
